export class TransitionManager{constructor(){this.app=document.getElementById("app"),this.customTransitions=new Map,this.transitionContext={}}init(){this.setupEventListeners()}setupEventListeners(){document.body.addEventListener("click",this.handleClick.bind(this)),window.addEventListener("popstate",this.handlePopState.bind(this))}handleClick(n){const t=n.target.closest("a");t&&t.origin===window.location.origin&&(n.preventDefault(),this.transitionContext={clickedElement:t,clickedRect:t.getBoundingClientRect(),targetPath:new URL(t.href).pathname},this.navigateTo(t.href))}async loadContent(n){try{const t=await fetch(`/__spa__${n}`);if(!t.ok)throw new Error("Page not found");const e=await t.json();document.startViewTransition?await document.startViewTransition(()=>{this.updateDOM(e),this.runCustomTransitions(n)}).finished:(this.updateDOM(e),this.runCustomTransitions(n))}catch(t){console.error("Error loading content:",t),this.app.innerHTML="<h1>404 - Page Not Found</h1>"}finally{this.transitionContext={}}}runCustomTransitions(n){const t=this.customTransitions.get(n);t&&t(this.transitionContext)}handlePopState(){this.loadContent(window.location.pathname)}async navigateTo(n){const t=new URL(n).pathname;document.startViewTransition?await document.startViewTransition(()=>{window.history.pushState({},"",t),this.loadContent(t)}).finished:(window.history.pushState({},"",t),await this.loadContent(t))}updateDOM(n){this.app.innerHTML=n.Content;const t=document.getElementById("dynamic-style")||document.createElement("style");t.id="dynamic-style",t.textContent=n.Style,t.parentNode||document.head.appendChild(t);const e=document.createElement("script");e.textContent=n.Script,document.body.appendChild(e)}registerCustomTransition(n,t){this.customTransitions.set(n,t)}}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiPHN0ZGluPiJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiLy8gdHJhbnNpdGlvbi1tYW5hZ2VyLmpzXG5cbmV4cG9ydCBjbGFzcyBUcmFuc2l0aW9uTWFuYWdlciB7XG5cdGNvbnN0cnVjdG9yKCkge1xuXHRcdHRoaXMuYXBwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcHBcIik7XG5cdFx0dGhpcy5jdXN0b21UcmFuc2l0aW9ucyA9IG5ldyBNYXAoKTtcblx0XHR0aGlzLnRyYW5zaXRpb25Db250ZXh0ID0ge307XG5cdH1cblxuXHRpbml0KCkge1xuXHRcdHRoaXMuc2V0dXBFdmVudExpc3RlbmVycygpO1xuXHR9XG5cblx0c2V0dXBFdmVudExpc3RlbmVycygpIHtcblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcykpO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgdGhpcy5oYW5kbGVQb3BTdGF0ZS5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdGhhbmRsZUNsaWNrKGUpIHtcblx0XHRjb25zdCBsaW5rID0gZS50YXJnZXQuY2xvc2VzdChcImFcIik7XG5cdFx0aWYgKGxpbmsgJiYgbGluay5vcmlnaW4gPT09IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdC8vIFN0b3JlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBjbGlja2VkIGVsZW1lbnRcblx0XHRcdHRoaXMudHJhbnNpdGlvbkNvbnRleHQgPSB7XG5cdFx0XHRcdGNsaWNrZWRFbGVtZW50OiBsaW5rLFxuXHRcdFx0XHRjbGlja2VkUmVjdDogbGluay5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxcblx0XHRcdFx0dGFyZ2V0UGF0aDogbmV3IFVSTChsaW5rLmhyZWYpLnBhdGhuYW1lLFxuXHRcdFx0fTtcblx0XHRcdHRoaXMubmF2aWdhdGVUbyhsaW5rLmhyZWYpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGxvYWRDb250ZW50KHBhdGgpIHtcblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL19fc3BhX18ke3BhdGh9YCk7XG5cdFx0XHRpZiAoIXJlc3BvbnNlLm9rKSB0aHJvdyBuZXcgRXJyb3IoXCJQYWdlIG5vdCBmb3VuZFwiKTtcblxuXHRcdFx0Y29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuXHRcdFx0aWYgKGRvY3VtZW50LnN0YXJ0Vmlld1RyYW5zaXRpb24pIHtcblx0XHRcdFx0YXdhaXQgZG9jdW1lbnQuc3RhcnRWaWV3VHJhbnNpdGlvbigoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy51cGRhdGVET00oZGF0YSk7XG5cdFx0XHRcdFx0dGhpcy5ydW5DdXN0b21UcmFuc2l0aW9ucyhwYXRoKTtcblx0XHRcdFx0fSkuZmluaXNoZWQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnVwZGF0ZURPTShkYXRhKTtcblx0XHRcdFx0dGhpcy5ydW5DdXN0b21UcmFuc2l0aW9ucyhwYXRoKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgY29udGVudDpcIiwgZXJyb3IpO1xuXHRcdFx0dGhpcy5hcHAuaW5uZXJIVE1MID0gXCI8aDE+NDA0IC0gUGFnZSBOb3QgRm91bmQ8L2gxPlwiO1xuXHRcdH0gZmluYWxseSB7XG5cdFx0XHQvLyBDbGVhciB0aGUgY29udGV4dCBhZnRlciB0aGUgdHJhbnNpdGlvblxuXHRcdFx0dGhpcy50cmFuc2l0aW9uQ29udGV4dCA9IHt9O1xuXHRcdH1cblx0fVxuXG5cdHJ1bkN1c3RvbVRyYW5zaXRpb25zKHBhdGgpIHtcblx0XHRjb25zdCB0cmFuc2l0aW9uRnVuYyA9IHRoaXMuY3VzdG9tVHJhbnNpdGlvbnMuZ2V0KHBhdGgpO1xuXHRcdGlmICh0cmFuc2l0aW9uRnVuYykge1xuXHRcdFx0dHJhbnNpdGlvbkZ1bmModGhpcy50cmFuc2l0aW9uQ29udGV4dCk7XG5cdFx0fVxuXHR9XG5cblx0aGFuZGxlUG9wU3RhdGUoKSB7XG5cdFx0dGhpcy5sb2FkQ29udGVudCh3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUpO1xuXHR9XG5cblx0YXN5bmMgbmF2aWdhdGVUbyh1cmwpIHtcblx0XHRjb25zdCBwYXRobmFtZSA9IG5ldyBVUkwodXJsKS5wYXRobmFtZTtcblx0XHRpZiAoZG9jdW1lbnQuc3RhcnRWaWV3VHJhbnNpdGlvbikge1xuXHRcdFx0YXdhaXQgZG9jdW1lbnQuc3RhcnRWaWV3VHJhbnNpdGlvbigoKSA9PiB7XG5cdFx0XHRcdHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7fSwgXCJcIiwgcGF0aG5hbWUpO1xuXHRcdFx0XHR0aGlzLmxvYWRDb250ZW50KHBhdGhuYW1lKTtcblx0XHRcdH0pLmZpbmlzaGVkO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIFwiXCIsIHBhdGhuYW1lKTtcblx0XHRcdGF3YWl0IHRoaXMubG9hZENvbnRlbnQocGF0aG5hbWUpO1xuXHRcdH1cblx0fVxuXG5cdHVwZGF0ZURPTShkYXRhKSB7XG5cdFx0dGhpcy5hcHAuaW5uZXJIVE1MID0gZGF0YS5Db250ZW50O1xuXG5cdFx0Ly8gQXBwbHkgc3R5bGVzXG5cdFx0Y29uc3Qgc3R5bGVFbGVtZW50ID1cblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZHluYW1pYy1zdHlsZVwiKSB8fFxuXHRcdFx0ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuXHRcdHN0eWxlRWxlbWVudC5pZCA9IFwiZHluYW1pYy1zdHlsZVwiO1xuXHRcdHN0eWxlRWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEuU3R5bGU7XG5cdFx0aWYgKCFzdHlsZUVsZW1lbnQucGFyZW50Tm9kZSkge1xuXHRcdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xuXHRcdH1cblxuXHRcdC8vIEV4ZWN1dGUgc2NyaXB0XG5cdFx0Y29uc3Qgc2NyaXB0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG5cdFx0c2NyaXB0RWxlbWVudC50ZXh0Q29udGVudCA9IGRhdGEuU2NyaXB0O1xuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0RWxlbWVudCk7XG5cdH1cblxuXHRyZWdpc3RlckN1c3RvbVRyYW5zaXRpb24ocGF0aCwgdHJhbnNpdGlvbkZ1bmMpIHtcblx0XHR0aGlzLmN1c3RvbVRyYW5zaXRpb25zLnNldChwYXRoLCB0cmFuc2l0aW9uRnVuYyk7XG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICJBQUVPLGFBQU0saUJBQWtCLENBQzlCLGFBQWMsQ0FDYixLQUFLLElBQU0sU0FBUyxlQUFlLEtBQUssRUFDeEMsS0FBSyxrQkFBb0IsSUFBSSxJQUM3QixLQUFLLGtCQUFvQixDQUFDLENBQzNCLENBRUEsTUFBTyxDQUNOLEtBQUssb0JBQW9CLENBQzFCLENBRUEscUJBQXNCLENBQ3JCLFNBQVMsS0FBSyxpQkFBaUIsUUFBUyxLQUFLLFlBQVksS0FBSyxJQUFJLENBQUMsRUFDbkUsT0FBTyxpQkFBaUIsV0FBWSxLQUFLLGVBQWUsS0FBSyxJQUFJLENBQUMsQ0FDbkUsQ0FFQSxZQUFZQSxFQUFHLENBQ2QsTUFBTUMsRUFBT0QsRUFBRSxPQUFPLFFBQVEsR0FBRyxFQUM3QkMsR0FBUUEsRUFBSyxTQUFXLE9BQU8sU0FBUyxTQUMzQ0QsRUFBRSxlQUFlLEVBRWpCLEtBQUssa0JBQW9CLENBQ3hCLGVBQWdCQyxFQUNoQixZQUFhQSxFQUFLLHNCQUFzQixFQUN4QyxXQUFZLElBQUksSUFBSUEsRUFBSyxJQUFJLEVBQUUsUUFDaEMsRUFDQSxLQUFLLFdBQVdBLEVBQUssSUFBSSxFQUUzQixDQUVBLE1BQU0sWUFBWUMsRUFBTSxDQUN2QixHQUFJLENBQ0gsTUFBTUMsRUFBVyxNQUFNLE1BQU0sV0FBV0QsQ0FBSSxFQUFFLEVBQzlDLEdBQUksQ0FBQ0MsRUFBUyxHQUFJLE1BQU0sSUFBSSxNQUFNLGdCQUFnQixFQUVsRCxNQUFNQyxFQUFPLE1BQU1ELEVBQVMsS0FBSyxFQUU3QixTQUFTLG9CQUNaLE1BQU0sU0FBUyxvQkFBb0IsSUFBTSxDQUN4QyxLQUFLLFVBQVVDLENBQUksRUFDbkIsS0FBSyxxQkFBcUJGLENBQUksQ0FDL0IsQ0FBQyxFQUFFLFVBRUgsS0FBSyxVQUFVRSxDQUFJLEVBQ25CLEtBQUsscUJBQXFCRixDQUFJLEVBRWhDLE9BQVNHLEVBQU8sQ0FDZixRQUFRLE1BQU0seUJBQTBCQSxDQUFLLEVBQzdDLEtBQUssSUFBSSxVQUFZLCtCQUN0QixRQUFFLENBRUQsS0FBSyxrQkFBb0IsQ0FBQyxDQUMzQixDQUNELENBRUEscUJBQXFCSCxFQUFNLENBQzFCLE1BQU1JLEVBQWlCLEtBQUssa0JBQWtCLElBQUlKLENBQUksRUFDbERJLEdBQ0hBLEVBQWUsS0FBSyxpQkFBaUIsQ0FFdkMsQ0FFQSxnQkFBaUIsQ0FDaEIsS0FBSyxZQUFZLE9BQU8sU0FBUyxRQUFRLENBQzFDLENBRUEsTUFBTSxXQUFXQyxFQUFLLENBQ3JCLE1BQU1DLEVBQVcsSUFBSSxJQUFJRCxDQUFHLEVBQUUsU0FDMUIsU0FBUyxvQkFDWixNQUFNLFNBQVMsb0JBQW9CLElBQU0sQ0FDeEMsT0FBTyxRQUFRLFVBQVUsQ0FBQyxFQUFHLEdBQUlDLENBQVEsRUFDekMsS0FBSyxZQUFZQSxDQUFRLENBQzFCLENBQUMsRUFBRSxVQUVILE9BQU8sUUFBUSxVQUFVLENBQUMsRUFBRyxHQUFJQSxDQUFRLEVBQ3pDLE1BQU0sS0FBSyxZQUFZQSxDQUFRLEVBRWpDLENBRUEsVUFBVUosRUFBTSxDQUNmLEtBQUssSUFBSSxVQUFZQSxFQUFLLFFBRzFCLE1BQU1LLEVBQ0wsU0FBUyxlQUFlLGVBQWUsR0FDdkMsU0FBUyxjQUFjLE9BQU8sRUFDL0JBLEVBQWEsR0FBSyxnQkFDbEJBLEVBQWEsWUFBY0wsRUFBSyxNQUMzQkssRUFBYSxZQUNqQixTQUFTLEtBQUssWUFBWUEsQ0FBWSxFQUl2QyxNQUFNQyxFQUFnQixTQUFTLGNBQWMsUUFBUSxFQUNyREEsRUFBYyxZQUFjTixFQUFLLE9BQ2pDLFNBQVMsS0FBSyxZQUFZTSxDQUFhLENBQ3hDLENBRUEseUJBQXlCUixFQUFNSSxFQUFnQixDQUM5QyxLQUFLLGtCQUFrQixJQUFJSixFQUFNSSxDQUFjLENBQ2hELENBQ0QiLAogICJuYW1lcyI6IFsiZSIsICJsaW5rIiwgInBhdGgiLCAicmVzcG9uc2UiLCAiZGF0YSIsICJlcnJvciIsICJ0cmFuc2l0aW9uRnVuYyIsICJ1cmwiLCAicGF0aG5hbWUiLCAic3R5bGVFbGVtZW50IiwgInNjcmlwdEVsZW1lbnQiXQp9Cg==
